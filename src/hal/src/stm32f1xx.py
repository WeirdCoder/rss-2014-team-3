RCC_BASE=0x40021000
RCC_APB2RSTR=0x0C
RCC_APB1RSTR=0x10
RCC_AHBENR=0x14
RCC_APB2ENR=0x18
RCC_APB1ENR=0x1C

APB1_TIM2=1<<0
APB1_TIM3=1<<1
APB1_TIM4=1<<2

APB2_AFIO=1<<0
APB2_IOPA=1<<2
APB2_IOPB=1<<3
APB2_IOPC=1<<4
APB2_IOPD=1<<5
APB2_IOPE=1<<6
APB2_IOPF=1<<7
APB2_IOPG=1<<8
APB2_ADC1=1<<9
APB2_ADC2=1<<10
APB2_TIM1=1<<11
APB2_SPI1=1<<12
APB2_TIM8=1<<13
APB2_USART1=1<<14
APB2_ADC3=1<<15

AFIO_BASE=0x40010000
AFIO_MAPR=0x04

GPIO_A_BASE = 0x40010800
GPIO_B_BASE = 0x40010C00
GPIO_C_BASE = 0x40011000
GPIO_D_BASE = 0x40011400
GPIO_E_BASE = 0x40011800
GPIO_F_BASE = 0x40011C00
GPIO_G_BASE = 0x40012000

GPIO_CRL = 0x00
GPIO_CRH = 0x04
GPIO_IDR = 0x08
GPIO_ODR = 0x0C
GPIO_BSRR = 0x10
GPIO_BRR = 0x14

GPIO_MODE_INPUT = 0b00
GPIO_MODE_OUTPUT = 0b11
GPIO_MODE_INPUT_ANALOG = 0b0000 | GPIO_MODE_INPUT
GPIO_MODE_INPUT_FLOATING = 0b0100 | GPIO_MODE_INPUT
GPIO_MODE_INPUT_PU_PD = 0b1000 | GPIO_MODE_INPUT
GPIO_MODE_OUTPUT_PP = 0b0000 | GPIO_MODE_OUTPUT
GPIO_MODE_OUTPUT_OD = 0b0100 | GPIO_MODE_OUTPUT
GPIO_MODE_OUTPUT_AF_PP = 0b1000 | GPIO_MODE_OUTPUT
GPIO_MODE_OUTPUT_AF_OD = 0b1100 | GPIO_MODE_OUTPUT
GPIO_MODE_MASK=0x0F

ADC1_BASE = 0x40012400

ADC_SR = 0x00
ADC_CR1 = 0x04
ADC_CR2 = 0x08
ADC_SMPR1 = 0x0C
ADC_SMPR2 = 0x10
ADC_SQR1 = 0x2C
ADC_SQR2 = 0x30
ADC_SQR3 = 0x34
ADC_DR = 0x4C

ADC_STRT = 1 << 4
ADC_EOC = 1 << 1

ADC_DUALMOD_SHIFT = 16
ADC_DUALMOD_MASK = 0b1111
ADC_DUALMOD_INDEPENDENT = 0b0000

ADC_DISCNUM_SHIFT = 12
ADC_DISCNUM_MASK = 0b111

ADC_DISCEN = 1 << 11
ADC_SCAN = 1 << 8

ADC_TSVREFE = 1 << 23
ADC_SWSTART = 1 << 22
ADC_EXTTRIG = 1 << 20
ADC_EXTSEL_SWSTART = 0b111 << 17
ADC_DMA = 1 << 8
ADC_RSTCAL = 1 << 3
ADC_CAL = 1 << 2
ADC_CONT = 1 << 1
ADC_ADON = 1 << 0

ADC_SMP_1_5_CYCLES = 0b000
ADC_SMP_7_5_CYCLES = 0b001
ADC_SMP_13_5_CYCLES = 0b010
ADC_SMP_28_5_CYCLES = 0b011
ADC_SMP_41_5_CYCLES = 0b100
ADC_SMP_55_5_CYCLES = 0b101
ADC_SMP_71_5_CYCLES = 0b110
ADC_SMP_239_5_CYCLES = 0b111

TIM1_BASE = 0x40012C00
TIM2_BASE = 0x40000000
TIM3_BASE = 0x40000400
TIM4_BASE = 0x40000800
TIM5_BASE = 0x40000C00
TIM6_BASE = 0x40001000
TIM7_BASE = 0x40001400

TIM_CR1 = 0x00
TIM_CR2 = 0x04
TIM_SMCR = 0x08
TIM_DIER = 0x0C
TIM_SR = 0x10
TIM_EGR = 0x14
TIM_CCMR1 = 0x18
TIM_CCMR2 = 0x1C
TIM_CCER = 0x20
TIM_CNT = 0x24
TIM_PSC = 0x28
TIM_ARR = 0x2C
TIM_RCR = 0x30
TIM_CCR1 = 0x34
TIM_CCR2 = 0x38
TIM_CCR3 = 0x3C
TIM_CCR4 = 0x40
TIM_BDTR = 0x44
TIM_DCR = 0x48
TIM_DMAR = 0x4C

TIM_CR1_CEN  = 0x0001
TIM_CR1_DIR  = 0x0010
TIM_CR1_CMS  = 0x0060
TIM_CR1_ARPE = 0x0080
TIM_CR1_CKD  = 0x0300

TIM_CKD_DIV1 = 0x0000
TIM_CKD_DIV2 = 0x0100
TIM_CKD_DIV4 = 0x0200

TIM_COUNTER_MODE_UP       = 0b000000000
TIM_COUNTER_MODE_DOWN     = 0b000010000
TIM_COUNTER_MODE_CENTER_1 = 0b000100000
TIM_COUNTER_MODE_CENTER_2 = 0b001000000
TIM_COUNTER_MODE_CENTER_3 = 0b001100000

TIM_PRELOAD_ENABLE  = 0x0080
TIM_PRELOAD_DISABLE = 0x0000

TIM_OCMODE_TIMING   = 0b000000000
TIM_OCMODE_ACTIVE   = 0b000010000
TIM_OCMODE_INACTIVE = 0b000100000
TIM_OCMODE_TOGGLE   = 0b000110000
TIM_OCMODE_PWM1     = 0b001100000
TIM_OCMODE_PWM2     = 0b001110000

TIM_OUTPUTSTATE_DISABLE = 0x0000
TIM_OUTPUTSTATE_ENABLE  = 0x0001

TIM_OCPOLARITY_HIGH = 0x0000
TIM_OCPOLARITY_LOW  = 0x0008

TIM_OUTPUTNSTATE_DISABLE = 0x0000
TIM_OUTPUTNSTATE_ENABLE  = 0x0004

TIM_OCNPOLARITY_HIGH = 0x0000
TIM_OCNPOLARITY_LOW  = 0x0008

TIM_OCIDLESTATE_SET   = 0x0100
TIM_OCIDLESTATE_RESET = 0x0000

TIM_OCNIDLESTATE_SET   = 0x0200
TIM_OCNIDLESTATE_RESET = 0x0000

TIM_CCER_CC1E  = 0x0001
TIM_CCER_CC1P  = 0x0002
TIM_CCER_CC1NE = 0x0004
TIM_CCER_CC1NP = 0x0008
TIM_CCER_CC2E  = 0x0010
TIM_CCER_CC2P  = 0x0020
TIM_CCER_CC2NE = 0x0040
TIM_CCER_CC2NP = 0x0080
TIM_CCER_CC3E  = 0x0100
TIM_CCER_CC3P  = 0x0200
TIM_CCER_CC3NE = 0x0400
TIM_CCER_CC3NP = 0x0800
TIM_CCER_CC4E  = 0x1000
TIM_CCER_CC4P  = 0x2000
TIM_CCER_CC4NE = 0x4000
TIM_CCER_CC4NP = 0x8000

TIM_CCMR1_CC1S   = 0x0003
TIM_CCMR1_OC1PE  = 0x0008
TIM_CCMR1_OC1M   = 0x0070
TIM_CCMR1_IC1PSC = 0x000C
TIM_CCMR1_IC1F   = 0x00F0
TIM_CCMR1_CC2S   = 0x0300
TIM_CCMR1_OC2PE  = 0x0800
TIM_CCMR1_OC2M   = 0x7000
TIM_CCMR1_IC2PSC = 0x0C00
TIM_CCMR1_IC2F   = 0xF000
TIM_CCMR2_CC3S   = 0x0003
TIM_CCMR2_OC3PE  = 0x0008
TIM_CCMR2_OC3M   = 0x0070
TIM_CCMR2_IC3PSC = 0x000C
TIM_CCMR2_IC3F   = 0x00F0
TIM_CCMR2_CC4S   = 0x0300
TIM_CCMR2_OC4PE  = 0x0800
TIM_CCMR2_OC4M   = 0x7000
TIM_CCMR2_IC4PSC = 0x0C00
TIM_CCMR2_IC4F   = 0xF000

TIM_CR2_OIS1  = 0x0100
TIM_CR2_OIS1N = 0x0200
TIM_CR2_OIS2  = 0x0400
TIM_CR2_OIS2N = 0x0800
TIM_CR2_OIS3  = 0x1000
TIM_CR2_OIS3N = 0x2000
TIM_CR2_OIS4  = 0x4000
TIM_CR2_OIS4N = 0x8000

TIM_PSCRELOADMODE_UPDATE    = 0x0000
TIM_PSCRELOADMODE_IMMEDIATE = 0x0001

TIM_OCPRELOAD_DISABLE = 0x0000
TIM_OCPRELOAD_ENABLE  = 0x0008

TIM_BDTR_MOE = 0x8000

TIM_ICSELECTION_DIRECTTI   = 0x0001
TIM_ICSELECTION_INDIRECTTI = 0x0002
TIM_ICSELECTION_TRC        = 0x0003

TIM_ICPSC_DIV1 = 0x0000
TIM_ICPSC_DIV2 = 0x0004
TIM_ICPSC_DIV4 = 0x0008
TIM_ICPSC_DIV8 = 0x000C

TIM_ICPOLARITY_RISING   = 0x0000
TIM_ICPOLARITY_FALLING  = 0x0002
TIM_ICPOLARITY_BOTHEDGE = 0x000A

TIM_INPUTSTATE_DISABLE = 0x0000
TIM_INPUTSTATE_ENABLE  = 0x0001

TIM_MASTERSLAVEMODE_ENABLE  = 0x0080
TIM_MASTERSLAVEMODE_DISABLE = 0x0000

TIM_SLAVEMODE_RESET     = 0x0004
TIM_SLAVEMODE_GATED     = 0x0005
TIM_SLAVEMODE_TRIGGER   = 0x0006
TIM_SLAVEMODE_EXTERNAL1 = 0x0007

TIM_TS_ITR0    = 0x0000
TIM_TS_ITR1    = 0x0010
TIM_TS_ITR2    = 0x0020
TIM_TS_ITR3    = 0x0030
TIM_TS_TI1F_ED = 0x0040
TIM_TS_TI1FP1  = 0x0050
TIM_TS_TI2FP2  = 0x0060
TIM_TS_ETRF    = 0x0070

TIM_SMCR_MSM = 0x0080
TIM_SMCR_TS  = 0x0070
TIM_SMCR_SMS = 0x0007

TIM_SR_CC1IF = 0x0002
TIM_SR_CC2IF = 0x0004
TIM_SR_CC3IF = 0x0008
TIM_SR_CC4IF = 0x0010

